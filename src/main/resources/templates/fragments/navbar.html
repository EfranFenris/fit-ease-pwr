<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <th:block th:fragment="nav-header">
        <style>
            .main-navbar {
                background: #ffffff;
                width: 100%;
                box-shadow: 0 1px 3px rgba(0,0,0,0.05);
                border-bottom: 1px solid #e2e8f0;
                font-family: 'Segoe UI', sans-serif;
            }

            .nav-grid-container {
                display: grid;
                grid-template-columns: auto 1fr auto;
                align-items: center;
                width: 100%;
                padding: 10px 40px;
                box-sizing: border-box;
            }

            .nav-column-left { display: flex; align-items: center; gap: 15px; }
            .nav-column-center {
                list-style: none;
                display: flex;
                gap: 35px;
                margin: 0;
                padding: 0;
                justify-content: center;
            }
            .nav-column-right { display: flex; justify-content: flex-end; align-items: center; }

            .nav-item {
                text-decoration: none;
                color: #64748b;
                font-weight: 600;
                font-size: 0.95rem;
                transition: color 0.2s;
            }
            .nav-item:hover, .nav-item.active { color: #5D5FEF; }

            .auth-text {
                background: none;
                border: none;
                color: #64748b;
                font-weight: 600;
                font-size: 0.9rem;
                cursor: pointer;
                text-decoration: none;
                transition: color 0.2s;
            }
            .auth-text:hover { color: #ef4444; }
        </style>
    </th:block>
</head>
<body>
<nav th:fragment="navbar" class="main-navbar">
    <div class="nav-grid-container">

        <div class="nav-column-left">
            <img th:src="@{/images/logo.png}" alt="Logo" style="height: 42px; width: auto;">
        </div>

        <ul class="nav-column-center" sec:authorize="isAuthenticated()">

            <li sec:authorize="hasAnyRole('user', 'admin')">
                <a th:href="@{/facilities}" class="nav-item"
                   th:classappend="${currentPage == 'facilities'} ? 'active' : ''">Facilities</a>
            </li>

            <li sec:authorize="hasAnyRole('user', 'admin', 'maintenance')">
                <a th:href="@{/calendar}" class="nav-item"
                   th:classappend="${currentPage == 'calendar'} ? 'active' : ''">Calendar</a>
            </li>

            <li sec:authorize="hasRole('user')">
                <a th:href="@{/reservations}" class="nav-item"
                   th:classappend="${currentPage == 'reservations'} ? 'active' : ''">My Bookings</a>
            </li>

            <li sec:authorize="hasRole('admin')">
                <a th:href="@{/reservations/manager}" class="nav-item"
                   th:classappend="${currentPage == 'manager'} ? 'active' : ''">Penalties</a>
            </li>

            <li sec:authorize="hasAnyRole('maintenance')">
                <a th:href="@{/maintenance-requests}" class="nav-item"
                   th:classappend="${currentPage == 'maintenance'} ? 'active' : ''">Maintenance</a>
            </li>

            <li sec:authorize="hasRole('admin')">
                <a th:href="@{/users}" class="nav-item"
                   th:classappend="${currentPage == 'users'} ? 'active' : ''">Users</a>
            </li>
        </ul>

        <div class="nav-column-right">
            <div sec:authorize="!isAuthenticated()" style="display: flex; gap: 12px;">
                <a th:href="@{/login}" class="auth-text" style="border: 2px solid #5D5FEF; padding: 8px 16px; border-radius: 8px; color: #5D5FEF;">Sign in</a>
                <a th:href="@{/signup}" class="auth-text" style="background: #5D5FEF; color: white; padding: 8px 16px; border-radius: 8px;">Sign up</a>
            </div>

            <div sec:authorize="isAuthenticated()" style="display: flex; align-items: center; gap: 15px;">
                <a th:href="@{/profile}" class="nav-item"
                   style="color: #4b3df0;"
                   th:text="${session.fullName != null ? session.fullName : #authentication.name}">My Profile</a>

                <form th:action="@{/logout}" method="post" style="margin:0;">
                    <button type="submit" class="auth-text">â†ª Log out</button>
                </form>
            </div>
        </div>

    </div>
</nav>
</body>
</html>